<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Fornecedores - An√°lise de Qualidade</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #7c3aed; border-bottom: 3px solid #7c3aed; padding-bottom: 10px; }
        h2 { color: #7c3aed; margin-top: 30px; }
        .section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #7c3aed;
            border-radius: 5px;
        }
        .success { color: #10B981; font-weight: bold; }
        .warning { color: #F59E0B; font-weight: bold; }
        .info { color: #7c3aed; font-weight: bold; }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 14px;
        }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #dee2e6; padding: 10px; text-align: left; }
        th { background: #f8f9fa; font-weight: bold; }
        .formula {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }
        ul { line-height: 1.8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè≠ Dashboard de Qualidade de Fornecedores</h1>
        
        <div class="section">
            <h2>‚úÖ Nova Aba Implementada no Dashboard</h2>
            
            <p><strong>Localiza√ß√£o:</strong> Dashboard ‚Üí Aba "Fornecedores"</p>
            
            <h3>üéØ Objetivo:</h3>
            <p>Comparar a quantidade de itens comprados (Amostragens 2.0) com as garantias geradas, calculando o percentual de qualidade de cada fornecedor.</p>
        </div>

        <div class="section">
            <h2>üìä C√°lculo da Qualidade</h2>
            
            <div class="formula">
                <strong>F√≥rmula:</strong><br>
                % Qualidade = ((Comprados - Garantias) / Comprados) √ó 100
            </div>
            
            <h3>Exemplo Pr√°tico:</h3>
            <table>
                <thead>
                    <tr>
                        <th>Cen√°rio</th>
                        <th>Comprados</th>
                        <th>Garantias</th>
                        <th>C√°lculo</th>
                        <th>% Qualidade</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Fornecedor Excelente</td>
                        <td>200 itens</td>
                        <td>1 garantia</td>
                        <td>((200 - 1) / 200) √ó 100</td>
                        <td class="success">99.50%</td>
                    </tr>
                    <tr>
                        <td>Fornecedor Bom</td>
                        <td>200 itens</td>
                        <td>10 garantias</td>
                        <td>((200 - 10) / 200) √ó 100</td>
                        <td class="success">95.00%</td>
                    </tr>
                    <tr>
                        <td>Fornecedor Regular</td>
                        <td>200 itens</td>
                        <td>30 garantias</td>
                        <td>((200 - 30) / 200) √ó 100</td>
                        <td class="warning">85.00%</td>
                    </tr>
                    <tr>
                        <td>Fornecedor Ruim</td>
                        <td>200 itens</td>
                        <td>60 garantias</td>
                        <td>((200 - 60) / 200) √ó 100</td>
                        <td style="color: #ef4444; font-weight: bold;">70.00%</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üîç Filtros Dispon√≠veis</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Filtro</th>
                        <th>Tipo</th>
                        <th>Descri√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Per√≠odo</strong></td>
                        <td>Obrigat√≥rio</td>
                        <td>Data inicial e final (ex: janeiro a julho)</td>
                    </tr>
                    <tr>
                        <td><strong>Filial</strong></td>
                        <td>Opcional</td>
                        <td>Filtrar por filial espec√≠fica</td>
                    </tr>
                    <tr>
                        <td><strong>Origem</strong></td>
                        <td>Opcional</td>
                        <td>Amostragem, Homologa√ß√£o ou Em Campo</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üìà Visualiza√ß√µes Dispon√≠veis</h2>
            
            <h3>1. üìä Gr√°fico de Barras - Qualidade por Fornecedor</h3>
            <ul>
                <li>Mostra o <strong>% de qualidade geral</strong> de cada fornecedor</li>
                <li>Ordenado do pior para o melhor (facilita identificar problemas)</li>
                <li>Cores: Roxo com gradiente</li>
                <li>Tooltip: Exibe percentual exato com 2 casas decimais</li>
            </ul>

            <h3>2. ü•ß Gr√°ficos de Pizza - Por Tipo de Produto</h3>
            <ul>
                <li><strong>Toners:</strong> Comprados vs Garantias</li>
                <li><strong>M√°quinas:</strong> Comprados vs Garantias</li>
                <li><strong>Pe√ßas:</strong> Comprados vs Garantias</li>
            </ul>

            <h3>3. üìã Tabela Detalhada</h3>
            <p>Mostra para cada fornecedor:</p>
            <table>
                <thead>
                    <tr>
                        <th>Coluna</th>
                        <th>Descri√ß√£o</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Fornecedor</td>
                        <td>Nome do fornecedor</td>
                    </tr>
                    <tr>
                        <td>Toners Comprados</td>
                        <td>Quantidade total de toners comprados</td>
                    </tr>
                    <tr>
                        <td>Garantias Toner</td>
                        <td>Garantias geradas de toners</td>
                    </tr>
                    <tr>
                        <td>% Qualidade Toner</td>
                        <td>Percentual de qualidade para toners</td>
                    </tr>
                    <tr>
                        <td colspan="2">... (mesmo para M√°quinas e Pe√ßas)</td>
                    </tr>
                    <tr>
                        <td><strong>% Qualidade Geral</strong></td>
                        <td><strong>Percentual geral do fornecedor</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üé® Cores por Qualidade</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Percentual</th>
                        <th>Cor</th>
                        <th>Significado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: #dcfce7;">
                        <td>‚â• 95%</td>
                        <td class="success">Verde</td>
                        <td>Excelente qualidade</td>
                    </tr>
                    <tr style="background: #dbeafe;">
                        <td>90% - 94.99%</td>
                        <td style="color: #3b82f6; font-weight: bold;">Azul</td>
                        <td>Muito bom</td>
                    </tr>
                    <tr style="background: #fef3c7;">
                        <td>80% - 89.99%</td>
                        <td class="warning">Amarelo</td>
                        <td>Bom (aten√ß√£o)</td>
                    </tr>
                    <tr style="background: #fed7aa;">
                        <td>70% - 79.99%</td>
                        <td style="color: #f97316; font-weight: bold;">Laranja</td>
                        <td>Regular (cuidado)</td>
                    </tr>
                    <tr style="background: #fee2e2;">
                        <td>< 70%</td>
                        <td style="color: #ef4444; font-weight: bold;">Vermelho</td>
                        <td>Ruim (cr√≠tico)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üîß Fonte de Dados</h2>
            
            <h3>üì¶ Itens Comprados:</h3>
            <p><strong>Origem:</strong> Amostragens 2.0</p>
            <code style="display: block; padding: 10px; margin: 10px 0;">
                SELECT <br>
                &nbsp;&nbsp;f.nome as fornecedor,<br>
                &nbsp;&nbsp;a.tipo_produto,<br>
                &nbsp;&nbsp;SUM(a.quantidade_recebida) as total_comprados<br>
                FROM amostragens_2 a<br>
                INNER JOIN fornecedores f ON a.fornecedor_id = f.id<br>
                INNER JOIN filiais fil ON a.filial_id = fil.id<br>
                WHERE DATE(a.created_at) BETWEEN '2025-01-01' AND '2025-07-31'<br>
                GROUP BY f.id, a.tipo_produto
            </code>

            <h3>‚ö†Ô∏è Garantias Geradas:</h3>
            <p><strong>Origem:</strong> M√≥dulo de Garantias</p>
            <code style="display: block; padding: 10px; margin: 10px 0;">
                SELECT <br>
                &nbsp;&nbsp;f.nome as fornecedor,<br>
                &nbsp;&nbsp;gi.tipo_produto,<br>
                &nbsp;&nbsp;COUNT(gi.id) as total_garantias<br>
                FROM garantias g<br>
                INNER JOIN garantias_itens gi ON g.id = gi.garantia_id<br>
                INNER JOIN fornecedores f ON g.fornecedor_id = f.id<br>
                WHERE DATE(g.created_at) BETWEEN '2025-01-01' AND '2025-07-31'<br>
                AND gi.tipo_produto IS NOT NULL<br>
                GROUP BY f.id, gi.tipo_produto
            </code>

            <h3>üîó Relacionamento:</h3>
            <ul>
                <li>Ambos vinculados ao <code>fornecedor_id</code> (tabela fornecedores)</li>
                <li>Filtrado por per√≠odo: <code>created_at</code> de ambas as tabelas</li>
                <li>Separado por tipo de produto (Toner, M√°quina, Pe√ßa)</li>
                <li>Amostragens: quantidade_recebida agregada por fornecedor e tipo</li>
                <li>Garantias: contagem de itens agregada por fornecedor e tipo</li>
            </ul>
            
            <h3>‚ö†Ô∏è Importante:</h3>
            <ul>
                <li><strong>Filtro de Filial:</strong> Aplica-se apenas √†s amostragens (garantias n√£o t√™m filial)</li>
                <li><strong>Filtro de Origem:</strong> Aplica-se apenas √†s garantias (Amostragem, Homologa√ß√£o, Em Campo)</li>
                <li><strong>tipo_produto:</strong> Deve estar preenchido nas garantias_itens para aparecer no dashboard</li>
            </ul>
        </div>

        <div class="section">
            <h2>üìä Cards Resumo</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Card</th>
                        <th>M√©trica</th>
                        <th>Cor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>üéØ Fornecedores Analisados</td>
                        <td>Total de fornecedores no per√≠odo</td>
                        <td style="background: #3b82f6; color: white;">Azul</td>
                    </tr>
                    <tr>
                        <td>üì¶ Total de Itens Comprados</td>
                        <td>Soma de todos os itens (Toner + M√°quina + Pe√ßa)</td>
                        <td style="background: #10b981; color: white;">Verde</td>
                    </tr>
                    <tr>
                        <td>‚ö†Ô∏è Total de Garantias</td>
                        <td>Soma de todas as garantias geradas</td>
                        <td style="background: #ef4444; color: white;">Vermelho</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>üß™ Como Testar</h2>
            
            <ol style="line-height: 2;">
                <li>Acesse: <code>https://djbr.sgqoti.com.br</code></li>
                <li>Fa√ßa login com usu√°rio que tenha permiss√£o de <strong>Dashboard</strong></li>
                <li>Clique na aba <strong>"üè≠ Fornecedores"</strong></li>
                <li>Selecione o per√≠odo: <code>01/01/2025 a 31/07/2025</code></li>
                <li>(Opcional) Selecione uma filial espec√≠fica</li>
                <li>(Opcional) Selecione uma origem (Amostragem, Homologa√ß√£o, Em Campo)</li>
                <li>Clique em <strong>"Aplicar Filtros"</strong></li>
                <li>Visualize os gr√°ficos e tabela com os dados</li>
            </ol>
            
            <h3 style="color: #ef4444; margin-top: 20px;">‚ö†Ô∏è Pr√©-requisitos para ver dados:</h3>
            <ul style="color: #dc2626;">
                <li><strong>Amostragens 2.0:</strong> Deve haver registros com quantidade_recebida > 0</li>
                <li><strong>Garantias:</strong> O campo <code>tipo_produto</code> deve estar preenchido em garantias_itens</li>
                <li><strong>Fornecedores:</strong> Devem estar cadastrados e vinculados corretamente</li>
                <li><strong>Per√≠odo:</strong> Deve conter dados dentro das datas selecionadas</li>
            </ul>
            
            <p style="background: #fef3c7; padding: 15px; border-left: 4px solid #f59e0b; margin-top: 15px;">
                <strong>üí° Dica:</strong> Se os gr√°ficos aparecerem vazios, verifique se existem dados de amostragens e garantias no per√≠odo selecionado. 
                Use um per√≠odo amplo (ex: todo o ano de 2025) para os primeiros testes.
            </p>
        </div>

        <div class="section">
            <h2>üí° Interpreta√ß√£o dos Resultados</h2>
            
            <h3>Exemplo Real:</h3>
            <p><strong>Fornecedor XYZ - Per√≠odo: Janeiro a Julho</strong></p>
            
            <table>
                <tr>
                    <td><strong>Toners Comprados:</strong></td>
                    <td>200 unidades</td>
                </tr>
                <tr>
                    <td><strong>Garantias de Toner:</strong></td>
                    <td>1 garantia</td>
                </tr>
                <tr>
                    <td><strong>% Qualidade Toner:</strong></td>
                    <td class="success">99.50%</td>
                </tr>
            </table>

            <p><strong>Interpreta√ß√£o:</strong></p>
            <ul>
                <li>De 200 toners comprados, apenas 1 gerou garantia</li>
                <li>Taxa de sucesso de <strong>99.50%</strong></li>
                <li>Fornecedor com <strong>excelente qualidade</strong></li>
                <li><span class="success">‚úÖ Recomendado para novas compras</span></li>
            </ul>
        </div>

        <div class="section">
            <h2>üéØ Casos de Uso</h2>
            
            <h3>1. Avalia√ß√£o de Fornecedores:</h3>
            <ul>
                <li>Identificar fornecedores com alta taxa de garantias</li>
                <li>Comparar qualidade entre diferentes fornecedores</li>
                <li>Tomar decis√µes de compra baseadas em dados</li>
            </ul>

            <h3>2. Negocia√ß√£o:</h3>
            <ul>
                <li>Usar dados para negociar melhor qualidade</li>
                <li>Solicitar melhorias em processos</li>
                <li>Estabelecer metas de qualidade</li>
            </ul>

            <h3>3. Relat√≥rios Gerenciais:</h3>
            <ul>
                <li>Apresentar an√°lise de qualidade para diretoria</li>
                <li>Justificar mudan√ßa de fornecedores</li>
                <li>Demonstrar economia com menos garantias</li>
            </ul>
        </div>

        <div class="section" style="background: #d1fae5; border-color: #10B981;">
            <h2>‚úÖ Implementa√ß√£o Completa!</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Componente</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Nova aba "Fornecedores" no Dashboard</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Filtros por Per√≠odo, Filial e Origem</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Gr√°fico de Qualidade por Fornecedor</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Gr√°ficos de Pizza por Tipo</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Tabela Detalhada</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Cards de Resumo</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>C√°lculo de % Qualidade</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Backend API</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Rota configurada</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                    <tr>
                        <td>Integra√ß√£o Amostragens 2.0 + Garantias</td>
                        <td class="success">‚úÖ Implementado</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; color: #059669; font-weight: bold;">
                üéâ Sistema completo para an√°lise de qualidade de fornecedores implementado com sucesso!
            </p>
        </div>

        <div class="section">
            <h2>üìã Arquivos Modificados/Criados</h2>
            
            <ul>
                <li><code>views/admin/dashboard.php</code> - Adicionada aba Fornecedores</li>
                <li><code>src/Controllers/AdminController.php</code> - M√©todo fornecedoresData()</li>
                <li><code>public/index.php</code> - Rota /admin/dashboard/fornecedores-data</li>
                <li><code>test_dashboard_fornecedores.html</code> - Documenta√ß√£o e testes</li>
            </ul>
        </div>
    </div>
</body>
</html>
